<div id="price_calc" style="background:#cccccc;">
		<table width="100%">
  <tr>
        	<td width="25%">
            	价格
            </td>
            <td width="25%">
            	<input type="text" value="0" id="calcPrice" size="10"/>
            </td>
        	<td width="25%">
            	原价格
            </td>
            <td width="25%"><input type="text" value="0" id="oldPrice"  readonly="readonly" size="10"/>
             </td>
        </tr>
        <tr>
			<td width="25%">
            算式
            </td>
            <td colspan="3" width="auto">
            <label id="expression"></label>
            </td>
        </tr>
        </table>     
        <table width="100%">
        	<tr>
        	<td width="15%"><input type="button" id="btndivby12" value="/12" /></td>
        	<td width="15%"><input type="button" id="btnmul30" value="*30" /></td>
        	<td width="15%"><input type="button" id="btnmularea" value="*面积" /></td>
            <td width="15%"><input type="button" id="btnputback" value="放回" /></td>
            <td width="15%"><input type="button" id="btnundo" value="还原" /></td>
            <td width="15%"><input type="button" id="reget" value="重取" /></td>
        </tr></table>      
</div>   
<link rel="stylesheet" href="/jquery/css/flora/flora.all.css" type="text/css">                    
<script src="/jquery/jquery.js"></script>
<script src="/jquery/ui/ui.core.js"></script>
<script src="/jquery/ui/ui.dialog.js"></script>
<script src="/jquery/ui/ui.resizable.js"></script>
<script src="/jquery/ui/ui.draggable.js"></script>
<script>
	$("#price_calc").dialog({width:"320px",height:"auto",resizable:true,autoOpen:false,title:"calc",position:['right','top'],dialogClass:"flora"});

	$("#btndivby12").click(function(){
		var theValue=getValue($("#calcPrice").attr("value"));
		var ex=$("#expression").text();
		if(ex.length>0){}else {ex=String(theValue);}

		$("#calcPrice").attr("value",theValue/12);

		ex=ex+"/12";
		$("#expression").text(ex);
	});

	$("#btnmul30").click(function(){
		var theValue=getValue($("#calcPrice").attr("value"));
		var ex=$("#expression").text();
		if(ex.length>0){}else {ex=String(theValue);}

		$("#calcPrice").attr("value",theValue*30);

		ex=ex+"*30";
		$("#expression").text(ex);
	});

	$("#btnundo").click(function(){
		var theValue=getValue($("#oldPrice").attr("value"));
		$("#calcPrice").attr("value",theValue);

		$("#expression").text("");
	});

	$("#reget").click(function(){
		var theValue=getValue($("#idPrice").attr("value"));
		$("#calcPrice").attr("value",theValue);
		$("#expression").text("");
	});

	$("#btnmularea").click(function(){
		var theValue=getValue($("#calcPrice").attr("value"));
		var bldgArea=getValue($("#bldgarea").attr("value"));
		var flArea=getValue($("#flarea").attr("value"));
		var theArea;
		var thePrice;
		if(bldgArea>0) theArea=bldgArea;
		else theArea=flArea;

		var ex=$("#expression").text();
		if(ex.length>0){}else {ex=String(theValue);}

		try
		{
			thePrice=theValue*theArea;
			$("#calcPrice").attr("value",thePrice);
		}
		catch(e)
		{
			$("#calcPrice").attr("value","");
		}
		
		ex=ex+"*面积";
		$("#expression").text(ex);
	});

	$("#showcalc").click(function(){
		$("#price_calc").dialog("open");
		$("#calcPrice").attr("value",$("#idPrice").attr("value"));
		$("#oldPrice").attr("value",$("#idPrice").attr("value"));
	});

	$("#btnputback").click(function(){
		$("#idPrice").attr("value",$("#calcPrice").attr("value"));
	});
	
	function getValue(theValue)
	{
		var newValue;
		try
		{
			newValue=theValue.match("\\d+(\\.\\d+)?")[0];
			return Number(newValue);	
		}
		catch(e)
		{
		}
		return 0;
	}
</script>
